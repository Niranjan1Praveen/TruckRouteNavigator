{% extends "base.html" %}

{% block title %}Track Drivers - Truck Mandi Tracker{% endblock %}

{% block head_extra %}
<style>
    .map-container {
        height: calc(100vh - 120px);
        width: 100%;
        position: relative;
    }
    
    #map {
        height: 100%;
        width: 100%;
        z-index: 1;
    }
    
    .info-panel {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 1000;
        width: 300px;
        background-color: rgba(33, 37, 41, 0.9);
        border-radius: 5px;
        padding: 15px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    }
    
    .truck-item {
        margin-bottom: 8px;
        padding: 8px;
        border-radius: 4px;
        background-color: rgba(45, 55, 60, 0.8);
    }
    
    .status-on-time {
        border-left: 4px solid #28a745;
    }
    
    .status-delayed {
        border-left: 4px solid #dc3545;
    }
</style>
{% endblock %}

{% block content %}
<div class="row mb-3">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <h1 class="h3 mb-0">
                <i class="fas fa-map-marker-alt text-primary me-2"></i>Live Truck Tracking
            </h1>
            <div class="d-flex align-items-center">
                <span id="update-status" class="badge bg-success me-2">Updates Active</span>
                <button id="toggle-updates" class="btn btn-sm btn-outline-secondary">
                    <i class="fas fa-pause me-1"></i>Pause
                </button>
            </div>
        </div>
        <p class="text-muted">Track the real-time location of truck drivers delivering to mandis across India</p>
    </div>
</div>

<div class="map-container">
    <div id="map">{{ map_html|safe }}</div>
    
    <div class="info-panel">
        <h5 class="mb-3">
            <i class="fas fa-truck me-2"></i>Truck Status
            <small class="text-muted float-end" id="last-updated"></small>
        </h5>
        <div id="truck-list" class="mb-3">
            <!-- Truck items will be populated via JavaScript -->
        </div>
        <div class="d-flex justify-content-between">
            <span class="badge bg-success"><i class="fas fa-circle me-1"></i> On Time</span>
            <span class="badge bg-danger"><i class="fas fa-circle me-1"></i> Delayed</span>
            <span class="badge bg-warning"><i class="fas fa-circle me-1"></i> < 1km</span>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/track_driver.js') }}"></script>
{% endblock %}
